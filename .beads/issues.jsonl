{"id":"ef-14q","title":"efrit-agent: Not available in autoload list","description":"efrit-agent module exists and loads when dependencies are available, but it's not registered in the autoload list in efrit.el. This means:\n\n1. M-x efrit-agent won't work without (require 'efrit-agent)\n2. The new agent buffer support isn't accessible to users\n3. It's inconsistent with how efrit-chat, efrit-do, etc. are exposed\n\nThe module at lisp/interfaces/efrit-agent.el has a public function efrit-agent but no autoload declaration in efrit.el.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-11-30T16:50:48.378723-08:00","updated_at":"2025-11-30T16:51:45.604501-08:00","closed_at":"2025-11-30T16:51:45.604501-08:00","close_reason":"Added efrit-agent to autoload list in efrit.el, also added to keybindings and help text"}
{"id":"ef-3ne","title":"efrit-chat: No session persistence or history navigation","description":"Unlike ChatGPT where you can:\n- View conversation history\n- Search/filter past conversations\n- Branch conversations at a specific point\n- Load old conversations back into the current session\n\nefrit-chat currently:\n- Has no persistent history across sessions\n- No way to view old conversations\n- Has (efrit-chat-persistence) module but only saves current session, no browsing\n- Clearing conversation with efrit-chat-clear loses everything\n\nWould benefit from:\n- Easy conversation history browser/search\n- Ability to recall previous responses\n- Export conversations to files\n- Resume previous conversations\"","status":"open","priority":3,"issue_type":"feature","created_at":"2025-11-30T17:14:30.68918-08:00","updated_at":"2025-11-30T17:14:30.68918-08:00"}
{"id":"ef-4iy","title":"efrit-chat: Missing conversation flow and transparency features","description":"Current efrit-chat treats each message as independent - there's no higher-level conversation state or multi-turn task orchestration. Compared to ChatGPT/Claude desktop:\n\nMissing features:\n1. No ability to have Claude ask clarifying questions in a natural way\n2. No natural back-and-forth for multi-step operations\n3. Tool execution happens silently - user can't see what tools Claude is calling or why\n4. No streaming or incremental response display (all or nothing)\n5. No visible \\\"thinking\\\" or step-by-step execution display\n\nThis makes conversations feel less natural and less transparent. Users can't see Claude's reasoning process.\"","status":"open","priority":2,"issue_type":"feature","created_at":"2025-11-30T17:14:24.219059-08:00","updated_at":"2025-11-30T17:14:24.219059-08:00"}
{"id":"ef-7xe","title":"efrit-chat: efrit-send-message fails when called programmatically","description":"When calling efrit-send-message programmatically (not via M-x), the message parameter is nil, causing \"Wrong type argument: stringp, nil\" error. This breaks batch testing and programmatic use of efrit-chat.\n\nSteps to reproduce:\n1. Create efrit-chat buffer\n2. Call (efrit-send-message \"test message\") directly\nResult: Error - message is nil\nExpected: Message is sent to API\n\nThe issue is that when called non-interactively, the message parameter isn't being bound properly.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-11-30T16:50:48.358441-08:00","updated_at":"2025-11-30T16:51:29.787493-08:00","closed_at":"2025-11-30T16:51:29.787493-08:00","close_reason":"Fixed by making efrit-chat return the buffer it creates and sets up"}
{"id":"ef-9la","title":"efrit-chat: Model version is outdated and causes API failures","description":"efrit-chat and efrit-chat-api were hardcoded to use 'claude-3-5-sonnet-20241022', an older model that no longer exists in the Anthropic API. This causes all chat messages to fail with 404/not_found_error responses.\n\nThe root cause was hardcoded model string instead of using efrit-default-model like efrit-do does.\n\nTesting confirmed:\n- efrit-do works correctly with the same API key\n- The correct model is 'claude-sonnet-4-5-20250929' as used in efrit-config\n\nFixed by updating chat modules to use efrit-default-model from efrit-config.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-11-30T17:13:42.72023-08:00","updated_at":"2025-11-30T17:13:44.289488-08:00","closed_at":"2025-11-30T17:13:44.289488-08:00","close_reason":"Fixed - updated efrit-chat and efrit-chat-api to use efrit-default-model from config instead of hardcoded deprecated model string\""}
{"id":"ef-a0o","title":"efrit-agent: Major mode not initialized when buffer is created","description":"The efrit-agent() function had inverted logic - it only activated efrit-agent-mode when the buffer was NOT live, but get-buffer-create always creates a live buffer. Result: efrit-agent buffer was in fundamental-mode instead of efrit-agent-mode.\n\nFixed by checking major-mode instead of buffer-live-p.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-11-30T16:53:01.054829-08:00","updated_at":"2025-11-30T16:53:02.48412-08:00","closed_at":"2025-11-30T16:53:02.48412-08:00","close_reason":"Fixed by checking major-mode instead of buffer-live-p"}
{"id":"ef-emc","title":"efrit-chat: Add tool to create and edit buffers","description":"The chat interface currently has tools for eval_sexp, get_context, read_image, and resolve_path, but lacks a high-level tool for common tasks like:\n- Creating new buffers with specific content\n- Editing/modifying existing file buffers\n- Writing text to specific locations in buffers\n\nWhile eval_sexp can do these things via Elisp, a higher-level abstraction would make Claude more naturally conversational and less likely to write complex elisp code when simpler operations would suffice.\n\nExample interaction user might expect:\n  User: \\\"Create a new buffer called *notes* with some todo items\\\"\n  Claude: [uses buffer creation tool rather than eval_sexp with complex elisp]\"","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-11-30T17:14:14.331793-08:00","updated_at":"2025-11-30T17:20:22.614529-08:00","closed_at":"2025-11-30T17:20:22.614529-08:00","close_reason":"Implemented buffer creation and editing tools for efrit-chat. Added create_buffer, edit_buffer, read_buffer, and buffer_info tools to both classic and streamlined chat modes."}
{"id":"ef-gcq","title":"efrit-chat: Async response handling doesn't work in batch/script mode","description":"When testing efrit-chat in batch mode or non-interactive Emacs, the async response callbacks from url-retrieve never fire. This makes programmatic testing and CI/CD integration difficult.\n\nSteps to reproduce:\n1. Run emacs --batch -l script.el where script.el calls efrit-chat and efrit-send-message\n2. Wait for expected response\n3. Response callback never fires, process exits\n\nThe issue is that batch Emacs doesn't have an event loop for handling async callbacks. Possible solutions:\n- Use sleep-for to wait in batch mode for callbacks to process\n- Detect batch mode and use synchronous requests instead\n- Document that efrit-chat is interactive-only and recommend efrit-do for batch usage\"","status":"open","priority":3,"issue_type":"task","created_at":"2025-11-30T17:14:18.083898-08:00","updated_at":"2025-11-30T17:14:18.083898-08:00"}
{"id":"ef-jb8","title":"efrit-chat: API returns 404 error on message send","description":"When using efrit-chat and sending messages, API requests fail with HTTP 404 error. This blocks interactive chat usage.\n\nSteps to reproduce:\n1. Call efrit-chat\n2. Send a message with (efrit-send-message \"...\")\nResult: HTTP 404 error (detected as (error http 404) in status plist)\nExpected: Message is sent and response is received\n\nInvestigation findings:\n- URL is correct: https://api.anthropic.com/v1/messages\n- HTTP method is correct: POST\n- Headers appear correct: x-api-key, anthropic-version, anthropic-beta, content-type\n- Request body is correct: valid JSON with model, max_tokens, temperature, messages\n- efrit-do works correctly with the same API key and configuration\n- The 404 comes from the HTTP status plist, not from Elisp error handling\n\nThe issue might be:\n- A difference in how url-retrieve is being called or configured\n- How url-request-data is being processed\n- A race condition or async handling issue\n- The actual error might not be a 404 but something else in the status tuple","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-11-30T16:52:28.358111-08:00","updated_at":"2025-11-30T17:08:23.704772-08:00","closed_at":"2025-11-30T17:08:23.704772-08:00","close_reason":"Fixed unicode escape sequence bug - was using \\\\\\\\u (4 backslashes) instead of \\\\u (2 backslashes) when encoding JSON, creating invalid JSON. Replaced manual escaping with efrit-common-escape-json-unicode in both classic and streamlined request builders."}
{"id":"ef-z8d","title":"efrit-chat: No error recovery or rate limiting display","description":"When API errors occur (rate limiting, timeouts, invalid requests), efrit-chat currently just shows a generic \\\"API Error\\\" message with no guidance on:\n- Whether the error is temporary (retry) vs permanent (fix request)\n- How long to wait for rate limiting\n- What went wrong with the request body\n\nBetter UX would show:\n- Error classification (rate limit vs auth vs bad request)\n- Suggested actions (\\\"wait 30 seconds then retry\\\" vs \\\"check your API key\\\")\n- Details about what was being sent when error occurred\n- Automatic retry with exponential backoff for rate limit errors\"","status":"open","priority":3,"issue_type":"feature","created_at":"2025-11-30T17:14:27.539407-08:00","updated_at":"2025-11-30T17:14:27.539407-08:00"}
